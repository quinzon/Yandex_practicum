x-common-variables: &common-variables
  networks:
    - ugc_test_network
  labels:
    com.example.project: "functional-ugc-tests"
  env_file:
    - .env.tests

services:
  mongo_test:
    image: mongo:8.0.4
    ports:
      - "27017:27017"

  ugc_service_test:
    build: ../../
    image: ugc_service
    <<: *common-variables
    entrypoint: [ "uvicorn", "src.main:app", "--host", "0.0.0.0", "--port", "8003", "--reload" ]

  wiremock:
    image: wiremock/wiremock:2.33.2
    container_name: wiremock
    ports:
      - "8080:8080"
    volumes:
      - ./wiremock/mappings:/home/wiremock/mappings
      - ./wiremock/__files:/home/wiremock/__files

networks:
  ugc_test_network:
